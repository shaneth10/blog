# 虚拟 DOM 简介

## 什么是虚拟 DOM

三大主流框架都是声明式操作 DOM 。我们通过描述状态和 DOM 之间的映射关系是怎么样的，就能将状态渲染成视图。

虚拟 DOM 的解决方式是通过状态生成一个虚拟节点树，然后使用虚拟节点树进行渲染。在渲染之前，会使用新生成的虚拟节点树和上一次生成的虚拟节点树进行对比，只渲染不同的部分。

虚拟节点树其实是由组件数建立起来的整个虚拟节点树。

## 为什么要引入虚拟 DOM

Vue.js 2.0 开始选择了一个中等力度的解决方案，那就是引入了虚拟 DOM。组件级别是一个 watcher 实例，就是说几遍一个组件内有 10 个节点使用了某个状态，但其实也只有一个 watcher 在观察这个状态的变化。所以当这个状态发生变化时，只能通知到组件，然后组件内部通过虚拟 DOM 去进行比对与渲染。

虚拟 DOM 在 Vue.js 中所做的事情其实并没有想象中那么复杂，它主要做了两件事。
  - 提供与真实 DOM 节点所对应的虚拟节点 vnode
  - 将虚拟节点 vnode 和虚拟节点 oldVnode 进行对比，然后更新视图。

对两个虚拟节点进行比对是虚拟 DOM 中最核心的算法（即 patch ），他可以判断出哪些节点发生了变化，从而只对发生了变化的节点进行更新操作。

## 总结

Vue.js 中通过模板来描述状态与视图的映射关系，所以它会先将模板编译成渲染函数，然后执行渲染函数生成虚拟节点，最后使用虚拟节点更新视图。